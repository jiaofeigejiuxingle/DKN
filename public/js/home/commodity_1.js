$(document).ready(function(){commodity_mark()});function commodity_addYgPrice(a){$.ajax({type:"POST",url:"/commodity/getPrices.sc",dataType:"json",data:"cNos="+a,success:function(f){var c=0;for(var b=0;b<f.length;b++){c=f[b];var e=c.active?c.active:c.sellPrice;$(".price_no"+c.no+" i").html(e).parent().siblings(".ico_discount").find("i").html(c.discount);var g=c.discount;g=g==10?10+" ":g;$(".discount_no"+c.no).html(g)}}})}function commodity_mark(h){var e=[];var g=false;var i=false;var b=false,d=false,f=false,c=false;if(h){strProductNos=h.split(",");e=strProductNos;g=true}else{$("sup.salepic2").each(function(){var j=$(this).attr("no");if(j&&j!=""){e.push(j);i=true}});$("sup.salepic").each(function(){var j=$(this).attr("no");if(j&&j!=""){e.push(j);g=true}});$(".cmdtyPrice").each(function(){var j=$(this).attr("no");if(j&&j!=""){e.push(j);b=true}})}if($("#newtopicbd")[0]){d=true;if($(".tpc_lst_module3,.tpc_lst_module2").length>0){c=true}}var a=e.join(";");if(e.length>0){if(d){commodity_addYgPrice(a)}$.post("/api/mark_new.jhtml",{cNos:a},function(o){if(o!=null&&o.length>0){var n=function(F){var z=o[F],s=z.no,r=z.activePrice,q=z.discount;if(r&&!d){var A=$(".price_no"+s);A.find("i").html(r);A.siblings(".ico_discount").find("i").html(q)}if(d&&c){q=q==10?10+" ":q;$("i.discount_no"+s).html(q)}if(!i&&!g){return}var E=z.marks;if(E!=null&&E!=""&&E.length>0&&!z.memberPrice){for(var C=0;C<E.length;C++){var v=E[C];var t=v.mark;var x=v.value;var H=v.lessSize;if(t==null&&t==""){continue}if(t=="sys"){if(x=="out"){if(i){$("sup.mark_big_"+s).html('<em class="markSoldOut"></em>').addClass("markSoldOut_sup")}if(g){$("sup.mark_small_"+s).html('<em class="markSoldOut"></em>').addClass("markSoldOut_sup")}}if(x=="less"){if(g){if(H&&H!=undefined){H="尺码："+H;$("sup.mark_small_"+s).html('<em class="markLess saleActiveRemark" >'+H+"</em>")}else{$("sup.mark_small_"+s).html('<em class="markLess saleActiveRemark"></em>')}}}}else{if(t=="promotion"&&g&&typeof(activeTopic)!="boolean"){var D=v.type;var p="";if(v.uLevel){p=v.uLevel+" "}if(D==1){if(v.loopLimit!=null&&v.loopLimit==0){$("sup.mark_small_"+s).html("<em class='saleActiveRemark mj'>"+p+"每满"+v.full+"<strong>减"+x+"</strong></em>")}else{$("sup.mark_small_"+s).html("<em class='saleActiveRemark mj'>"+p+"满"+v.full+"<strong>减"+x+"</strong></em>")}}else{if(D==2){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>"+p+"限时抢<strong>&yen;"+x+"</strong></em>")}else{if(D==8){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>"+p+"加价购</em>")}else{if(D==9){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>"+p+"下单立减<strong>&yen;"+x+"</strong></em>")}else{if(D==10||D==11){var B=[];var y="折";var w=v.specMark;if(D==11){y="元"}if(w){$.each(w,function(J,I){B.push(I.number+"件"+I.value+y)})}$("sup.mark_small_"+s).html("<em class='saleActiveRemark mj'>"+p+B.join("，")+"</em>")}else{if(D==13){$("sup.mark_small_"+s).html("<em class='saleActiveRemark mzk'>"+p+"满"+v.full+"<strong>享"+x+"折</strong></em>")}else{if(D==14||D==15){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>"+p+"送赠品</em>")}else{if(D==17){$("sup.mark_small_"+s).html("<em class='saleActiveRemark mj'>"+p+v.full+"件套装"+v.value+"元</em>")}else{if(D==18){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>预约购买</em>")}else{if(D==19){var u=v.number;$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>限量抢购"+u+"件</em>")}else{if(D==21){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>"+p+"秒杀<strong>&yen;"+x+"</strong></em>")}else{if(D==22){$("sup.mark_small_"+s).html("<em class='saleActiveRemark xsq'>"+p+"闪团<strong>&yen;"+x+"</strong></em>")}}}}}}}}}}}}}else{if(t=="ordinary"){var G='<em class="markNew saleActiveRemark"></em>';if(v.small.indexOf("seoul")>0){G='<em class="saleBigActiveRemarkred">up to 50%off</em>'}if(i){$("sup.mark_big_"+s).html(G)}if(g){$("sup.mark_small_"+s).html(G)}}}}}}};var l=30,k=0,j=o.length;var m=function(){k++;for(var p=(k-1)*l;p<l*k&&p<j;p++){n(p)}if(p<j){setTimeout(m,3000)}};m(k)}},"json")}};